<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1f2937">
    <title>Flash Cards Pro</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎯</text></svg>">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
        }
        html, body { 
            margin: 0; 
            padding: 0; 
            width: 100%; 
            height: 100%; 
            overflow-x: hidden; 
            font-family: system-ui, -apple-system, sans-serif;
        }
        #root {
            min-height: 100vh;
        }
        .perspective-1000 { perspective: 1000px; }
        .transform-style-preserve-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .line-clamp-2 { 
            display: -webkit-box; 
            -webkit-line-clamp: 2; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
        }
        button:active { transform: scale(0.98); }
        @media screen and (max-width: 768px) { 
            input, textarea, select { font-size: 16px !important; } 
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, createContext, useContext } = React;

        // Simple Icons (replacing lucide-react)
        const Icon = ({ name, className = "w-5 h-5" }) => {
            const icons = {
                search: "🔍",
                plus: "➕",
                moon: "🌙",
                sun: "☀️",
                menu: "☰",
                cards: "🎴",
                study: "📚",
                stats: "📊",
                edit: "✏️",
                delete: "🗑️",
                check: "✅",
                x: "❌",
                clock: "⏰",
                volume: "🔊",
                brain: "🧠",
                zap: "⚡",
                target: "🎯",
                trend: "📈"
            };
            
            return React.createElement('span', {
                className: `inline-block ${className}`,
                style: { fontSize: '1.2em' }
            }, icons[name] || "📝");
        };

        // Context
        const FlashCardsContext = createContext(null);

        const useFlashCards = () => {
            const context = useContext(FlashCardsContext);
            if (!context) throw new Error('useFlashCards must be used within FlashCardsProvider');
            return context;
        };

        // Storage Service
        class StorageService {
            static STORAGE_KEY = 'flashcards-pro-enhanced';
            
            static save(state) {
                try {
                    const data = {
                        ...state,
                        categories: Array.from(state.categories),
                    };
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
                } catch (error) {
                    console.error('Failed to save data:', error);
                }
            }
            
            static load() {
                try {
                    const data = localStorage.getItem(this.STORAGE_KEY);
                    if (!data) return null;
                    
                    const parsed = JSON.parse(data);
                    return {
                        ...parsed,
                        categories: new Set(parsed.categories || []),
                    };
                } catch (error) {
                    console.error('Failed to load data:', error);
                    return null;
                }
            }
            
            static exportData(state) {
                const data = {
                    version: '3.0',
                    exported: new Date().toISOString(),
                    ...state,
                    categories: Array.from(state.categories),
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `flashcards-pro-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        // Mobile Card Component
        function MobileCardItem({ card, onEdit, onDelete, onStudy }) {
            const { state: { theme } } = useFlashCards();
            const [showActions, setShowActions] = useState(false);
            
            return (
                <div className={`relative mb-3 rounded-xl border transition-all cursor-pointer ${
                    theme === 'dark' 
                        ? 'bg-gray-800 border-gray-700' 
                        : 'bg-white border-gray-200'
                }`}>
                    <div className="p-4" onClick={() => setShowActions(!showActions)}>
                        <div className="flex justify-between items-start mb-2">
                            <h4 className="font-medium text-base leading-tight pr-2 flex-1">{card.question}</h4>
                            <span className={`text-xs px-2 py-1 rounded flex-shrink-0 ${
                                card.difficulty === 'easy' 
                                    ? 'bg-green-500 text-white'
                                    : card.difficulty === 'medium'
                                    ? 'bg-yellow-500 text-white'
                                    : 'bg-red-500 text-white'
                            }`}>
                                {card.difficulty}
                            </span>
                        </div>
                        
                        <p className={`text-sm mb-3 line-clamp-2 ${
                            theme === 'dark'
