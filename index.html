<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1f2937">
    <title>Flash Cards Pro</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎯</text></svg>">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
        }
        html, body { 
            margin: 0; 
            padding: 0; 
            width: 100%; 
            height: 100%; 
            overflow-x: hidden; 
            font-family: system-ui, -apple-system, sans-serif;
        }
        #root {
            min-height: 100vh;
        }
        .perspective-1000 { perspective: 1000px; }
        .transform-style-preserve-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        .line-clamp-2 { 
            display: -webkit-box; 
            -webkit-line-clamp: 2; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
        }
        button:active { transform: scale(0.98); }
        @media screen and (max-width: 768px) { 
            input, textarea, select { font-size: 16px !important; } 
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, createContext, useContext } = React;

        // Simple Icons (replacing lucide-react)
        const Icon = ({ name, className = "w-5 h-5" }) => {
            const icons = {
                search: "🔍",
                plus: "➕",
                moon: "🌙",
                sun: "☀️",
                menu: "☰",
                cards: "🎴",
                study: "📚",
                stats: "📊",
                edit: "✏️",
                delete: "🗑️",
                check: "✅",
                x: "❌",
                clock: "⏰",
                volume: "🔊",
                brain: "🧠",
                zap: "⚡",
                target: "🎯",
                trend: "📈"
            };
            
            return React.createElement('span', {
                className: `inline-block ${className}`,
                style: { fontSize: '1.2em' }
            }, icons[name] || "📝");
        };

        // Context
        const FlashCardsContext = createContext(null);

        const useFlashCards = () => {
            const context = useContext(FlashCardsContext);
            if (!context) throw new Error('useFlashCards must be used within FlashCardsProvider');
            return context;
        };

        // Storage Service
        class StorageService {
            static STORAGE_KEY = 'flashcards-pro-enhanced';
            
            static save(state) {
                try {
                    const data = {
                        ...state,
                        categories: Array.from(state.categories),
                    };
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
                } catch (error) {
                    console.error('Failed to save data:', error);
                }
            }
            
            static load() {
                try {
                    const data = localStorage.getItem(this.STORAGE_KEY);
                    if (!data) return null;
                    
                    const parsed = JSON.parse(data);
                    return {
                        ...parsed,
                        categories: new Set(parsed.categories || []),
                    };
                } catch (error) {
                    console.error('Failed to load data:', error);
                    return null;
                }
            }
            
            static exportData(state) {
                const data = {
                    version: '3.0',
                    exported: new Date().toISOString(),
                    ...state,
                    categories: Array.from(state.categories),
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `flashcards-pro-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        // Mobile Card Component
        function MobileCardItem({ card, onEdit, onDelete, onStudy }) {
            const { state: { theme } } = useFlashCards();
            const [showActions, setShowActions] = useState(false);
            
            return (
                <div className={`relative mb-3 rounded-xl border transition-all cursor-pointer ${
                    theme === 'dark' 
                        ? 'bg-gray-800 border-gray-700' 
                        : 'bg-white border-gray-200'
                }`}>
                    <div className="p-4" onClick={() => setShowActions(!showActions)}>
                        <div className="flex justify-between items-start mb-2">
                            <h4 className="font-medium text-base leading-tight pr-2 flex-1">{card.question}</h4>
                            <span className={`text-xs px-2 py-1 rounded flex-shrink-0 ${
                                card.difficulty === 'easy' 
                                    ? 'bg-green-500 text-white'
                                    : card.difficulty === 'medium'
                                    ? 'bg-yellow-500 text-white'
                                    : 'bg-red-500 text-white'
                            }`}>
                                {card.difficulty}
                            </span>
                        </div>
                        
                        <p className={`text-sm mb-3 line-clamp-2 ${
                            theme === 'dark' ? 'text-gray-400' : 'text-gray-600'
                        }`}>
                            {card.answer}
                        </p>
                        
                        <div className="flex flex-wrap gap-1">
                            {card.category && (
                                <span className={`text-xs px-2 py-1 rounded ${
                                    theme === 'dark' ? 'bg-blue-900 text-blue-300' : 'bg-blue-100 text-blue-700'
                                }`}>
                                    {card.category}
                                </span>
                            )}
                            {card.tags.slice(0, 2).map(tag => (
                                <span key={tag} className={`text-xs px-2 py-1 rounded ${
                                    theme === 'dark' ? 'bg-gray-700 text-gray-300' : 'bg-gray-100 text-gray-700'
                                }`}>
                                    {tag}
                                </span>
                            ))}
                        </div>
                    </div>
                    
                    {/* Action buttons */}
                    <div className={`overflow-hidden transition-all duration-300 ${
                        showActions ? 'max-h-16' : 'max-h-0'
                    }`}>
                        <div className={`flex border-t ${theme === 'dark' ? 'border-gray-700' : 'border-gray-200'}`}>
                            <button
                                onClick={(e) => {
                                    e.stopPropagation();
                                    onStudy();
                                }}
                                className={`flex-1 py-3 px-4 text-sm font-medium text-blue-500 ${
                                    theme === 'dark' ? 'hover:bg-gray-700' : 'hover:bg-gray-50'
                                } border-r ${theme === 'dark' ? 'border-gray-700' : 'border-gray-200'}`}
                            >
                                Study
                            </button>
                            <button
                                onClick={(e) => {
                                    e.stopPropagation();
                                    onEdit();
                                }}
                                className={`flex-1 py-3 px-4 text-sm font-medium ${
                                    theme === 'dark' ? 'hover:bg-gray-700' : 'hover:bg-gray-50'
                                } border-r ${theme === 'dark' ? 'border-gray-700' : 'border-gray-200'}`}
                            >
                                Edit
                            </button>
                            <button
                                onClick={(e) => {
                                    e.stopPropagation();
                                    onDelete();
                                }}
                                className={`flex-1 py-3 px-4 text-sm font-medium text-red-500 ${
                                    theme === 'dark' ? 'hover:bg-gray-700' : 'hover:bg-gray-50'
                                }`}
                            >
                                Delete
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Mobile Study Card
        function MobileStudyCard({ card, isFlipped, onFlip }) {
            const { state: { theme } } = useFlashCards();
            
            return (
                <div className="relative w-full h-80 perspective-1000" onClick={onFlip}>
                    <div className={`relative w-full h-full transition-transform duration-500 transform-style-preserve-3d cursor-pointer ${
                        isFlipped ? 'rotate-y-180' : ''
                    }`}>
                        {/* Front - Question */}
                        <div className={`absolute inset-0 backface-hidden rounded-2xl p-6 flex flex-col ${
                            theme === 'dark' 
                                ? 'bg-gradient-to-br from-gray-800 to-gray-900 text-white' 
                                : 'bg-gradient-to-br from-white to-gray-100'
                        } shadow-xl border ${theme === 'dark' ? 'border-gray-700' : 'border-gray-200'}`}>
                            
                            <div className="flex justify-between items-start mb-4">
                                <span className={`text-xs px-2 py-1 rounded ${
                                    card.difficulty === 'easy' 
                                        ? 'bg-green-500 text-white'
                                        : card.difficulty === 'medium'
                                        ? 'bg-yellow-500 text-white'
                                        : 'bg-red-500 text-white'
                                }`}>
                                    {card.difficulty}
                                </span>
                            </div>
                            
                            <div className="flex-1 flex items-center justify-center p-2">
                                <div className="text-center">
                                    <h2 className="text-lg font-medium mb-4 leading-relaxed">{card.question}</h2>
                                </div>
                            </div>
                            
                            <div className="text-center text-xs opacity-60">
                                Tap to reveal answer
                            </div>
                        </div>
                        
                        {/* Back - Answer */}
                        <div className={`absolute inset-0 backface-hidden rotate-y-180 rounded-2xl p-6 flex flex-col ${
                            theme === 'dark' 
                                ? 'bg-gradient-to-br from-blue-900 to-blue-800 text-white' 
                                : 'bg-gradient-to-br from-blue-50 to-blue-100'
                        } shadow-xl border ${theme === 'dark' ? 'border-gray-700' : 'border-gray-200'}`}>
                            
                            <div className="flex-1 flex items-center justify-center p-2">
                                <div className="text-center">
                                    <h2 className="text-lg font-medium leading-relaxed whitespace-pre-line">{card.answer}</h2>
                                </div>
                            </div>
                            
                            <div className="text-center text-xs opacity-60">
                                Tap to show question
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Study Mode Component
        function MobileStudyMode({ cards, onComplete }) {
            const { state: { theme } } = useFlashCards();
            const [currentIndex, setCurrentIndex] = useState(0);
            const [isFlipped, setIsFlipped] = useState(false);
            const [results, setResults] = useState({ correct: 0, incorrect: 0 });
            const [startTime] = useState(Date.now());
            const [showCompletePrompt, setShowCompletePrompt] = useState(false);
            
            const currentCard = cards[currentIndex];
            const progress = ((currentIndex + 1) / cards.length) * 100;
            
            const handleResponse = (isCorrect) => {
                if (isCorrect) {
                    setResults(prev => ({ ...prev, correct: prev.correct + 1 }));
                } else {
                    setResults(prev => ({ ...prev, incorrect: prev.incorrect + 1 }));
                }
                
                if (currentIndex < cards.length - 1) {
                    setTimeout(() => {
                        setCurrentIndex(prev => prev + 1);
                        setIsFlipped(false);
                    }, 800);
                } else {
                    setShowCompletePrompt(true);
                }
            };
            
            const handleComplete = () => {
                const duration = Math.floor((Date.now() - startTime) / 1000);
                onComplete({ ...results, duration });
            };
            
            if (!currentCard) {
                return (
                    <div className="flex items-center justify-center h-96">
                        <div className="text-center">
                            <Icon name="study" className="w-16 h-16 mx-auto mb-4 text-gray-400" />
                            <p className="text-lg">No cards to study</p>
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="space-y-4 pb-6">
                    {/* Progress */}
                    <div className="p-4 rounded-xl">
                        <div className="flex justify-between items-center mb-2">
                            <span className="text-sm font-medium">
                                {currentIndex + 1} / {cards.length}
                            </span>
                            <div className="flex items-center gap-4">
                                <div className="flex items-center gap-1">
                                    <Icon name="check" className="w-4 h-4 text-green-500" />
                                    <span className="text-sm">{results.correct}</span>
                                </div>
                                <div className="flex items-center gap-1">
                                    <Icon name="x" className="w-4 h-4 text-red-500" />
                                    <span className="text-sm">{results.incorrect}</span>
                                </div>
                            </div>
                        </div>
                        <div className={`h-2 rounded-full overflow-hidden ${
                            theme === 'dark' ? 'bg-gray-700' : 'bg-gray-200'
                        }`}>
                            <div
                                className="h-full bg-blue-500 transition-all duration-500"
                                style={{ width: `${progress}%` }}
                            />
                        </div>
                    </div>
                    
                    {/* Study Card */}
                    <div className="px-4">
                        <MobileStudyCard
                            card={currentCard}
                            isFlipped={isFlipped}
                            onFlip={() => setIsFlipped(!isFlipped)}
                        />
                    </div>
                    
                    {/* Controls */}
                    <div className="px-4">
                        {isFlipped ? (
                            <div className="grid grid-cols-2 gap-3">
                                <button
                                    onClick={() => handleResponse(false)}
                                    className="py-4 bg-red-500 text-white rounded-xl hover:bg-red-600 font-medium"
                                >
                                    ❌ Incorrect
                                </button>
                                <button
                                    onClick={() => handleResponse(true)}
                                    className="py-4 bg-green-500 text-white rounded-xl hover:bg-green-600 font-medium"
                                >
                                    ✅ Correct
                                </button>
                            </div>
                        ) : (
                            <button
                                onClick={() => setIsFlipped(true)}
                                className="w-full py-4 bg-blue-500 text-white rounded-xl hover:bg-blue-600 text-lg font-medium"
                            >
                                Show Answer
                            </button>
                        )}
                    </div>
                    
                    {/* Complete Session Prompt */}
                    {showCompletePrompt && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className={`w-full max-w-sm rounded-2xl p-6 ${
                                theme === 'dark' ? 'bg-gray-900' : 'bg-white'
                            }`}>
                                <h3 className="text-xl font-semibold mb-4 text-center">Session Complete! 🎉</h3>
                                <div className="space-y-3 mb-6">
                                    <div className="flex justify-between">
                                        <span>Cards studied:</span>
                                        <span className="font-medium">{results.correct + results.incorrect}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Correct:</span>
                                        <span className="font-medium text-green-500">{results.correct}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Incorrect:</span>
                                        <span className="font-medium text-red-500">{results.incorrect}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Accuracy:</span>
                                        <span className="font-medium">
                                            {results.correct + results.incorrect > 0
                                                ? Math.round((results.correct / (results.correct + results.incorrect)) * 100)
                                                : 0}%
                                        </span>
                                    </div>
                                </div>
                                <button
                                    onClick={handleComplete}
                                    className="w-full py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 font-medium"
                                >
                                    Finish Session
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Card Editor
        function MobileCardEditor({ card, onSave, onCancel }) {
            const { state: { theme } } = useFlashCards();
            const [question, setQuestion] = useState(card?.question || '');
            const [answer, setAnswer] = useState(card?.answer || '');
            const [category, setCategory] = useState(card?.category || '');
            const [difficulty, setDifficulty] = useState(card?.difficulty || 'medium');
            
            const handleSubmit = () => {
                if (!question.trim() || !answer.trim()) return;
                
                onSave({
                    question: question.trim(),
                    answer: answer.trim(),
                    category: category.trim(),
                    tags: [],
                    difficulty,
                    media: [],
                });
            };
            
            return (
                <div className="space-y-6">
                    <div>
                        <label className="block text-sm font-medium mb-2">Question</label>
                        <textarea
                            value={question}
                            onChange={(e) => setQuestion(e.target.value)}
                            className={`w-full px-4 py-3 rounded-xl border ${
                                theme === 'dark' 
                                    ? 'bg-gray-800 border-gray-700 text-white' 
                                    : 'bg-white border-gray-300'
                            } focus:outline-none focus:ring-2 focus:ring-blue-500 text-base`}
                            rows={3}
                            placeholder="Enter your question..."
                            required
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-2">Answer</label>
                        <textarea
                            value={answer}
                            onChange={(e) => setAnswer(e.target.value)}
                            className={`w-full px-4 py-3 rounded-xl border ${
                                theme === 'dark' 
                                    ? 'bg-gray-800 border-gray-700 text-white' 
                                    : 'bg-white border-gray-300'
                            } focus:outline-none focus:ring-2 focus:ring-blue-500 text-base`}
                            rows={3}
                            placeholder="Enter the answer..."
                            required
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-2">Category</label>
                        <input
                            value={category}
                            onChange={(e) => setCategory(e.target.value)}
                            className={`w-full px-4 py-3 rounded-xl border ${
                                theme === 'dark' 
                                    ? 'bg-gray-800 border-gray-700 text-white' 
                                    : 'bg-white border-gray-300'
                            } focus:outline-none focus:ring-2 focus:ring-blue-500 text-base`}
                            placeholder="Optional category"
                        />
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium mb-3">Difficulty</label>
                        <div className="grid grid-cols-3 gap-3">
                            {['easy', 'medium', 'hard'].map(level => (
                                <button
                                    key={level}
                                    type="button"
                                    onClick={() => setDifficulty(level)}
                                    className={`py-3 rounded-xl border transition-colors text-sm font-medium ${
                                        difficulty === level
                                            ? level === 'easy'
                                                ? 'bg-green-500 text-white border-green-500'
                                                : level === 'medium'
                                                ? 'bg-yellow-500 text-white border-yellow-500'
                                                : 'bg-red-500 text-white border-red-500'
                                            : theme === 'dark'
                                            ? 'border-gray-700 hover:border-gray-600'
                                            : 'border-gray-300 hover:border-gray-400'
                                    }`}
                                >
                                    {level.charAt(0).toUpperCase() + level.slice(1)}
                                </button>
                            ))}
                        </div>
                    </div>
                    
                    <div className="flex gap-3 pt-4">
                        <button
                            type="button"
                            onClick={onCancel}
                            className={`flex-1 py-3 rounded-xl border ${
                                theme === 'dark' 
                                    ? 'border-gray-700 hover:bg-gray-800' 
                                    : 'border-gray-300 hover:bg-gray-100'
                            } transition-colors font-medium`}
                        >
                            Cancel
                        </button>
                        <button
                            type="button"
                            onClick={handleSubmit}
                            disabled={!question.trim() || !answer.trim()}
                            className="flex-1 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium"
                        >
                            {card ? 'Update' : 'Create'}
                        </button>
                    </div>
                </div>
            );
        }

        // Provider Component
        function FlashCardsProvider({ children }) {
            const [state, setState] = useState(() => {
                const saved = StorageService.load();
                return {
                    cards: saved?.cards || [
                        {
                            id: '1',
                            question: 'Q1) Explain why MUST there be a safe system of work.',
                            answer: 'It is a LEGAL requirement under the HASWA 1974.',
                            category: 'Crane Operations',
                            tags: ['safety', 'legal', 'HASWA'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '41',
                            question: 'Q41) What are the types of warning indicated by RCI and at what point are they activated?',
                            answer: 'AMBER 90-97.6%\nRED light with external alarm 102.5-110%',
                            category: 'Crane Operations',
                            tags: ['RCI', 'warnings', 'alarm systems'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '42',
                            question: 'Q42) a) Where would the duty board of a tower crane normally be located and b) Name FOUR types of information that it must contain',
                            answer: 'a) Located at the base of the tower crane\nb) 1. Make\n2. Model\n3. Serial number\n4. Capacity at maximum radius',
                            category: 'Crane Operations',
                            tags: ['tower crane', 'duty board', 'information'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '43',
                            question: 'Q43) How could the deflection of a boom or jib on a mobile-type crane affect a lift?',
                            answer: 'The boom deflection can cause an increase in the radius.',
                            category: 'Crane Operations',
                            tags: ['boom deflection', 'radius', 'mobile crane'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '44',
                            question: 'Q44) Why must a lifting equipment operator never try to \'side load\' and \'drag\' a load?',
                            answer: 'Because it can induce side loading on the boom (for which it wasn\'t designed) and can cause structural failure.',
                            category: 'Crane Operations',
                            tags: ['side loading', 'dragging', 'structural failure'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '45',
                            question: 'Q45) On mobile and crawler cranes, in what situation can a single load be lifted using the fly jib hook block & min book hook block simultaneously?',
                            answer: 'If it is stated by the manufacturer.',
                            category: 'Crane Operations',
                            tags: ['dual hook', 'manufacturer', 'mobile crane'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '46',
                            question: 'Q46) On both tracked and wheeled 360 degree excavators: a) What differs between lifting over the side of the machine compared to lifting the front or the rear of the machine? b) Explain why.',
                            answer: 'a) Increased stability when lifting over the front and back, over the side a reduction of capacity\nb) Reduced stability base',
                            category: 'Crane Operations',
                            tags: ['excavators', 'stability', 'lifting positions'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '47',
                            question: 'Q47) Name FOUR factors relating to ground that a ground engineer would need to taken into account when determining the load bearing capacity of ground',
                            answer: '1. Ability of the ground to support the gross weight of the machine and load\n2. Integrity of adjacent ground to withstand lateral stresses imposed\n3. Levelling and preparation\n4. Underground services',
                            category: 'Crane Operations',
                            tags: ['ground conditions', 'load bearing', 'engineering'],
                            difficulty: 'hard',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '48',
                            question: 'Q48) The area of mat size has been correctly specified for use with the outriggers of a mobile crane and the intended load and operating radius but the pad not stiff or rigid enough (e.g. it is too thin). Explain the possible consequence.',
                            answer: 'The mat will be unable to spread the outrigger point load uniformly and will risk sinking in and destabilizing the crane.',
                            category: 'Crane Operations',
                            tags: ['outrigger mats', 'stability', 'load distribution'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '49',
                            question: 'Q49) Identify FOUR requirements for ensuring the stability of mobile cranes on site.',
                            answer: '1. Firm/level standing\n2. All outriggers extended accordingly\n3. Crane level both longitudinally and transversely\n4. All wheels clear of the ground\n5. Crane not overloaded',
                            category: 'Crane Operations',
                            tags: ['stability', 'mobile cranes', 'requirements'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '50',
                            question: 'Q50) Outline the role of the Temporary Works Coordinator.',
                            answer: '1. Co-ordinate all temporary works activities\n2. Ensure a temporary works register is established and maintained\n3. Ensure that responsibilities are accepted\n4. Ensure that a design brief is prepared with the actual situation on site',
                            category: 'Crane Operations',
                            tags: ['temporary works', 'coordinator', 'responsibilities'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '51',
                            question: 'Q51) Who is responsible for compiling all necessary documentation when lifting close proximity to a site boundary? E.g. protection fans?',
                            answer: 'Temp works coordinator',
                            category: 'Crane Operations',
                            tags: ['site boundary', 'documentation', 'protection'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '52',
                            question: 'Q52) A platform is being used to receive lifted loads of materials. What primary procedure must be in place to ensure that the platform being used is suitable and sufficient to hold the weight of the load?',
                            answer: 'Temporary works design.',
                            category: 'Crane Operations',
                            tags: ['platform', 'temporary works', 'load capacity'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '53',
                            question: 'Q53) What are the THREE key fundamental aspects that need considering when preparing a design for any temporary works design/structure?',
                            answer: '1. foundation\n2. structure\n3. stability',
                            category: 'Crane Operations',
                            tags: ['temporary works', 'design', 'fundamentals'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '54',
                            question: 'Q54) List FOUR items of information that must be included on a temporary works register.',
                            answer: '1. Design Checker\n2. Date design complete\n3. Date design checked/approved\n4. Erection complete and checked or "Permit to Load", "Permit to Dismantle"',
                            category: 'Crane Operations',
                            tags: ['temporary works', 'register', 'documentation'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '55',
                            question: 'Q55) a) What is the recommended minimum exclusion zone around overhead power lines, b) Where can this information be sourced and c) Explain why a distance from overhead power lines should be kept.',
                            answer: 'a) 275KW-400KW 7M\n132KW 6M\n11KW-33KW 3M\nLow voltage 1M\nb) BS6 HSE\nc) Because electricity can arch across large gaps',
                            category: 'Crane Operations',
                            tags: ['power lines', 'exclusion zone', 'electrical safety'],
                            difficulty: 'hard',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '56',
                            question: 'Q56) When planning a lift near a slope, what is the minimum distance to be kept between the supporting components of the lifting equipment and the slope?',
                            answer: 'Edge of the mat to the edge of the slope should be double of height of slope.',
                            category: 'Crane Operations',
                            tags: ['slopes', 'distance', 'safety margins'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '57',
                            question: 'Q57) If planning to lift loads In or near a pedestrianized area, what main factor needs to be taken into account?',
                            answer: 'Physical segregation of pedestrians from overhead loads. Create an exclusion zone.',
                            category: 'Crane Operations',
                            tags: ['pedestrians', 'exclusion zone', 'public safety'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '58',
                            question: 'Q58) Two cranes are working in the same vicinity that encroach the operating radius of each. What actions should the lift plan or method statement normally specify?',
                            answer: 'Have crane coordinator in place or anti-collision and crash radios.',
                            category: 'Crane Operations',
                            tags: ['multiple cranes', 'coordination', 'collision avoidance'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '59',
                            question: 'Q59) In what circumstances would aviation warning lighting be required to high -type lifting equipment?',
                            answer: 'If the lifting equipment is within 6km of an aerodrome and the overall height exceeds 10 metres above nearby existing structures and trees.',
                            category: 'Crane Operations',
                            tags: ['aviation', 'warning lights', 'aerodrome'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '60',
                            question: 'Q60) Identify 4 types of infrastructure where a responsible body or owner would have to be notified when planning a lift on or near by.',
                            answer: '1. Rivers\n2. Airfields\n3. Highways\n4. Railways\n5. Live plant',
                            category: 'Crane Operations',
                            tags: ['infrastructure', 'notifications', 'planning'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '61',
                            question: 'Q61) Name a design of accessory hook that is exempt from being fitted with a safety catch.',
                            answer: 'A \'C\' type Hook.',
                            category: 'Crane Operations',
                            tags: ['hooks', 'safety catch', 'exemptions'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '62',
                            question: 'Q62) Name THREE markings found on multiple-leg slings.',
                            answer: '1. SWL (WLL)\n2. Manufactures name\n3. Serial number',
                            category: 'Crane Operations',
                            tags: ['slings', 'markings', 'identification'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '63',
                            question: 'Q63) State the maximum recommended included angle for single-leg slings when used as a pair.',
                            answer: 'Maximum 90 degrees.',
                            category: 'Crane Operations',
                            tags: ['slings', 'angles', 'recommendations'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '64',
                            question: 'Q64) Give TWO methods of obtaining the centre of gravity on an unbalanced load.',
                            answer: '1. Calculation\n2. Trial lift',
                            category: 'Crane Operations',
                            tags: ['centre of gravity', 'unbalanced loads', 'methods'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '65',
                            question: 'Q65) In which applications are single leg slings rated with their own SWL (WLL)?',
                            answer: 'Only when used vertically.',
                            category: 'Crane Operations',
                            tags: ['single leg slings', 'SWL', 'vertical use'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '66',
                            question: 'Q66) How is the SWL/WLL/rated capacity for multi-legs slings determined?',
                            answer: 'By the Uniform Load method.',
                            category: 'Crane Operations',
                            tags: ['multi-leg slings', 'SWL', 'uniform load'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '67',
                            question: 'Q67) To lift a load of 20 tonnes on a 4 single leg chain sling, what is the required SWL (WLL) for each leg with an included angle of 87 degrees? Please explain your calculation.',
                            answer: '1. 9.52 tonnes/each leg\n2. When using 4 leg chain sling the same calculation as 3 leg chain sling is used because it is considered that not all 4 legs are taking the weight equal. So: 20 tonnes divided by 2.1 (mod factor for 3 legs and 87 degrees angle) = 9.52 tonne each leg. 4x10 slings needed.',
                            category: 'Crane Operations',
                            tags: ['chain slings', 'calculations', 'load distribution'],
                            difficulty: 'hard',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '68',
                            question: 'Q68) How should multiple accessories be connected to a crane hook?',
                            answer: 'Using a master ring and bow shackles.',
                            category: 'Crane Operations',
                            tags: ['accessories', 'connections', 'rigging'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '69',
                            question: 'Q69) State SIX environmental factors that can affect an external lifting operation.',
                            answer: '1. wind\n2. Fog\n3. Mist\n4. Excessive rain\n5. Lightning\n6. Storms\n7. Ice and snow',
                            category: 'Crane Operations',
                            tags: ['environmental factors', 'weather', 'external operations'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '70',
                            question: 'Q70) Name FOUR factors should be taken into account when calculating the effects of wind on a crane-based lifting operation',
                            answer: '1. The geometry and shape of the load\n2. The height to which the load is to be lifted\n3. The wind direction\n4. Operating between structures',
                            category: 'Crane Operations',
                            tags: ['wind effects', 'calculations', 'factors'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '71',
                            question: 'Q71) Give THREE examples of how excessive rain can affect an external lifting operation when using lifting equipment.',
                            answer: '1. Excessive rain can cause the ground to soften reducing the crane support\n2. Poor visibility\n3. Cause slippery conditions and reduce traction',
                            category: 'Crane Operations',
                            tags: ['rain effects', 'ground conditions', 'visibility'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '72',
                            question: 'Q72) Outline THREE principle requirements for out of service procedures for tower cranes.',
                            answer: '1. Remove accessories and jib in free slew\n2. Out of radius of other cranes and obstructions\n3. Lock up and isolate crane',
                            category: 'Crane Operations',
                            tags: ['tower cranes', 'out of service', 'procedures'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '73',
                            question: 'Q73) Using the given lifting capacity diagram for the JC8 525/125 telescopic handler using a hook (A61): a) What is the maximum lifting capacity? b) What is the maximum lifting capacity when free on wheels (FOW) c) What the maximum hook height where a load can be lifted d) What is the maximum lifting capacity when the hook is at a height of 8m and the boom at an angle of 45 degrees?',
                            answer: 'a) 3500 kg\nb) 0kg\nc) 10m\nd) 1000kg',
                            category: 'Crane Operations',
                            tags: ['telescopic handler', 'capacity diagram', 'specifications'],
                            difficulty: 'hard',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '21',
                            question: 'Q21) Name THREE factors to be taken into account when devising a mobile lifting equipment marshalling plan.',
                            answer: '1. Visibility\n2. Attaching / Detaching and securing loads\n3. Environment',
                            category: 'Crane Operations',
                            tags: ['marshalling', 'planning', 'factors'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '22',
                            question: 'Q22) Name THREE possible effects that fatigue can have on a lifting team.',
                            answer: '1. Decreased productivity\n2. Reduced safe working ability\n3. Absenteeism',
                            category: 'Crane Operations',
                            tags: ['fatigue', 'safety', 'effects'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '23',
                            question: 'Q23) Name SIX principle factors should be taken into account in relation to fatigue management of a lifting operation.',
                            answer: '1. Comply with your organization\'s policies and procedures relating fatigue\n2. Understand your sleep, rest and recovery needs and obtain adequate rest and sleep away from work\n3. Seek medical advice and assistance if you have a concern about a health condition that affects your sleep or causes fatigue\n4. Look out for signs of fatigue at the people you work with\n5. In consultations with your supervisor, take steps to manage fatigue\n6. Maintain hydration',
                            category: 'Crane Operations',
                            tags: ['fatigue management', 'safety', 'health'],
                            difficulty: 'hard',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '24',
                            question: 'Q24) State THREE occasions on which lifting equipment must be thoroughly examined.',
                            answer: '1. When lifting equipment is first supplied (used for the first time by the employer)\n2. When certain equipment is installed (e.g. tower crane)\n3. Periodically during the lifetime of the equipment\n4. Following exceptional circumstances',
                            category: 'Crane Operations',
                            tags: ['examination', 'inspection', 'maintenance'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '25',
                            question: 'Q25) How long is a thorough examination for a lifting accessory valid for?',
                            answer: '6 months.',
                            category: 'Crane Operations',
                            tags: ['examination', 'validity', 'accessory'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '26',
                            question: 'Q26) Name FOUR items that must be recorded when a thorough examination on a lifting appliance has been carried out.',
                            answer: '1. Defects\n2. SWL\n3. Model of the machine\n4. Examination location',
                            category: 'Crane Operations',
                            tags: ['examination', 'recording', 'documentation'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '27',
                            question: 'Q27) List TWO methods of obtaining the accurate weight of a load.',
                            answer: '1. Manufacturer\'s data\n2. Trial lift (using a weight load cell)',
                            category: 'Crane Operations',
                            tags: ['load weight', 'measurement', 'accuracy'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '28',
                            question: 'Q28) During dismantling operations, what factor of safety is applied to the load?',
                            answer: 'Minimum of 20%',
                            category: 'Crane Operations',
                            tags: ['dismantling', 'safety factor', 'operations'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '29',
                            question: 'Q29) If an object has to be dismantled above ground to be lifted to ground level (and can\'t be returned to the original position), what factor of safety should be applied?',
                            answer: '2:1',
                            category: 'Crane Operations',
                            tags: ['dismantling', 'safety factor', 'ground level'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '30',
                            question: 'Q30) Name THREE factors(configurations) that determine the rated lifting capacity of lifting equipment.',
                            answer: '1. Boom angle\n2. Spread of outriggers\n3. The radius',
                            category: 'Crane Operations',
                            tags: ['lifting capacity', 'configuration', 'factors'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '31',
                            question: 'Q31) What does the term \'structural strength\' relate to with regard to the lifting capacity of any lifting equipment?',
                            answer: 'Structural strength refers to where the maximum SWL is limited by the structural strength of all relevant components. Example boom, outriggers, slew ring, chassis.',
                            category: 'Crane Operations',
                            tags: ['structural strength', 'SWL', 'components'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '32',
                            question: 'Q32) Name the sections in 7121 where advice is given on \'Lifting without outriggers\' and \'Pick and carry\'.',
                            answer: '12.1.5 Lifting without outriggers\n12.1.6 Pick and Carry',
                            category: 'Crane Operations',
                            tags: ['BS 7121', 'outriggers', 'pick and carry'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '33',
                            question: 'Q33) Define the term \'radius\'.',
                            answer: 'The radius is the horizontal distance between the points at which the centre of rotation meets the ground and the vertical centre line passing through the load lifting attachment.',
                            category: 'Crane Operations',
                            tags: ['radius', 'definitions', 'measurements'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '34',
                            question: 'Q34) If a crane is out of level, what effect will it have on the radius?',
                            answer: 'Increase on low side, decrease on high side.',
                            category: 'Crane Operations',
                            tags: ['level', 'radius', 'effects'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '35',
                            question: 'Q35) What is the definition of the term "outreach"?',
                            answer: 'The horizontal measurement from the centre of the hook block to the nearest part of the crane (excluding boom).',
                            category: 'Crane Operations',
                            tags: ['outreach', 'definitions', 'measurements'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '36',
                            question: 'Q36) If a load of 20 tonnes is lifted on four falls of rope, what is the tension in each fall?',
                            answer: '20 tonnes / 4 falls = 5 tonnes each fall',
                            category: 'Crane Operations',
                            tags: ['rope tension', 'calculations', 'load distribution'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '37',
                            question: 'Q37) What advantage is gained by increasing the number of falls on a hook block?',
                            answer: 'Increasing the falls could increase lifting capacity (for a particular configuration).',
                            category: 'Crane Operations',
                            tags: ['hook block', 'falls', 'capacity'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '38',
                            question: 'Q38) State the safe procedure to be followed before lifting or lowering a load down a shaft or excavation.',
                            answer: 'The empty hook must be lowered down to working level and the hoist drum checked for sufficient turns on the drum.',
                            category: 'Crane Operations',
                            tags: ['shaft lifting', 'safety procedures', 'excavation'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '39',
                            question: 'Q39) When planning a lifting operation to place loads below ground level, what needs to be taken into account when calculating the gross weight of the load?',
                            answer: 'The weight of the rope below ground level will need to be factored into the gross weight of the load.',
                            category: 'Crane Operations',
                            tags: ['below ground', 'rope weight', 'calculations'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '40',
                            question: 'Q40) Explain the purpose of the over-hoist limit switch?',
                            answer: 'To stop the hook from hitting the boom head.',
                            category: 'Crane Operations',
                            tags: ['limit switch', 'safety', 'over-hoist'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '2',
                            question: 'Q2) a) State the legislation and the regulation therein that refers to the stability of cranes and b) Which regulation states the requirement for all lifting operations to be properly planned?',
                            answer: 'a) LOLER Regulation 4\nb) LOLER Regulation 8',
                            category: 'Crane Operations',
                            tags: ['LOLER', 'legislation', 'planning'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '3',
                            question: 'Q3) a) State the regulation number for the lifting of persons under LOLER 1998 and b) List FIVE requirements to be within a procedure.',
                            answer: 'a) LOLER Regulation 5\nb) 1. Has suitable devices to prevent the risk of carrier falling\n2. A person trapped in any carrier can be freed\n3. The carrier has an enhanced safety coefficient suspension rope or chain\n4. The rope or chain is inspected by a competent person every working day\n5. The use of carrier clearly marked for personnel use',
                            category: 'Crane Operations',
                            tags: ['LOLER', 'personnel', 'safety'],
                            difficulty: 'hard',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '4',
                            question: 'Q4) a) What is the \'Factor of Safety\' when lifting personnel and b) What needs to be taken into account with wind speeds?',
                            answer: 'a) 2:1\nb) maximum wind speeds of 7m/s',
                            category: 'Crane Operations',
                            tags: ['safety', 'personnel', 'wind'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '5',
                            question: 'Q5) How does the guidance in LOLER 1998 (L 113) describe the difference between installed and positioned?',
                            answer: 'Installed – fixed in location (tower crane)\nPositioned – manoeuvred in to place (mobile crane)',
                            category: 'Crane Operations',
                            tags: ['LOLER', 'definitions', 'crane types'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '6',
                            question: 'Q6) a) What is the minimum recommended distance that is allowed between the counterweight(s) of any lifting equipment and an object/structure and b) What measure must be taken if the distance is less?',
                            answer: 'a) Minimum 600 mm.\nb) Prevent access',
                            category: 'Crane Operations',
                            tags: ['counterweight', 'distance', 'safety'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '7',
                            question: 'Q7) Who has overall control of the lifting operation?',
                            answer: 'The Appointed Person',
                            category: 'Crane Operations',
                            tags: ['appointed person', 'control', 'responsibility'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '8',
                            question: 'Q8) What IS the definition of a competent person as stated by Codes of Practice?',
                            answer: 'A person who has practical and theoretical knowledge as well as planning experience of crane and equipment.',
                            category: 'Crane Operations',
                            tags: ['competent person', 'definitions', 'qualifications'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '9',
                            question: 'Q9) Which part of BS 7121 is specific to mobile cranes?',
                            answer: 'Sections 2-3',
                            category: 'Crane Operations',
                            tags: ['BS 7121', 'mobile cranes', 'standards'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '10',
                            question: 'Q10) When a crane company hires out a crane, name TWO main legal requirements the hire company must meet regarding the crane and operator.',
                            answer: '1. A competent trained operator\n2. Correct and up-to-date certification',
                            category: 'Crane Operations',
                            tags: ['hire', 'legal requirements', 'operator'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '11',
                            question: 'Q11) Explain the difference between an employing and user organisation.',
                            answer: 'Employing Organisation requires the load to be lifted\nUser Organisation and plan and manoeuvres the lift for the client.',
                            category: 'Crane Operations',
                            tags: ['organisations', 'definitions', 'responsibilities'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '12',
                            question: 'Q12) Who is responsible for providing the contractor with written details of the work to be done?',
                            answer: 'The Employing Organisation',
                            category: 'Crane Operations',
                            tags: ['employing organisation', 'documentation', 'responsibility'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '13',
                            question: 'Q13) Where would the information relating to the additional requirements of an intermediate lift over a basic lift be sought?',
                            answer: 'Explained in BS 7121, 4.3.2 for basic lift, 4.3.3. for intermediate/standard lift',
                            category: 'Crane Operations',
                            tags: ['BS 7121', 'lift types', 'standards'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '14',
                            question: 'Q14) To whom should the appointed person give all details involving the lifting operation?',
                            answer: 'Crane supervisor and anyone involved.',
                            category: 'Crane Operations',
                            tags: ['appointed person', 'communication', 'supervision'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '15',
                            question: 'Q15) Why is it recommended to complete a report after the completion of the lifting operation?',
                            answer: 'To evaluate the lifting operation where good practice can be utilized in future lifts or where the operation could have been planned more effectively. The client/contractor may further require written feedback on the operation.',
                            category: 'Crane Operations',
                            tags: ['reporting', 'evaluation', 'improvement'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '16',
                            question: 'Q16) A change of crane lifting equipment operator is required. What must they be made aware of before continuing?',
                            answer: 'The lift plan and any other relevant issue.',
                            category: 'Crane Operations',
                            tags: ['operator change', 'lift plan', 'communication'],
                            difficulty: 'easy',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '17',
                            question: 'Q17) Name TWO duties of the crane operator.',
                            answer: '1. Operate crane according to manufactures instructions\n2. Implement the lift plan and safe system of work',
                            category: 'Crane Operations',
                            tags: ['operator duties', 'safety', 'procedures'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '18',
                            question: 'Q18) Describe FOUR factors that need to be taken into account when specifying communication procedures for a lifting operation.',
                            answer: '1. Communication method established before the lift\n2. Banksman/Signaller shall be visible/audible at all times\n3. The operator shall obey stop signals whoever gives them\n4. The Person in Charge shall be clearly identified and made known to all members of the lift team and personnel in the proximity.',
                            category: 'Crane Operations',
                            tags: ['communication', 'procedures', 'safety'],
                            difficulty: 'hard',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '19',
                            question: 'Q19) If radios are to be used during the lifting operations, what FIVE actions and checks must be made before use?',
                            answer: '1. Check if people involved know how to use them\n2. Check if batteries will last for the duration of the operation or spare batteries are supplied\n3. Check if all involved in the lifting are on the same frequency (channel)\n4. Check if the signal strength is sufficient\n5. Check if the frequency is clear from other interferences',
                            category: 'Crane Operations',
                            tags: ['radios', 'communication', 'checks'],
                            difficulty: 'hard',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        },
                        {
                            id: '20',
                            question: 'Q20) Name the FOUR stages of the hierarchy of control for the marshalling of mobile lifting equipment.',
                            answer: '1. Elimination/substitution\n2. Engineering\n3. Administration\n4. PPE',
                            category: 'Crane Operations',
                            tags: ['hierarchy of control', 'marshalling', 'safety'],
                            difficulty: 'medium',
                            media: [],
                            created: new Date().toISOString(),
                            lastStudied: null,
                            nextReview: null,
                            timesStudied: 0,
                            timesCorrect: 0,
                            easeFactor: 2.5,
                            interval: 0,
                            repetitions: 0,
                            lapses: 0,
                        }
                    ],
                    categories: saved?.categories || new Set(['Crane Operations']),
                    studySessions: saved?.studySessions || [],
                    cardProgress: saved?.cardProgress || {},
                    theme: saved?.theme || 'dark',
                    settings: saved?.settings || {
                        dailyGoal: 20,
                        notificationsEnabled: false,
                        soundEnabled: true,
                        autoAdvance: true,
                        studyReminders: [],
                        speechEnabled: true,
                        speechRate: 1.0,
                        speechVoice: '',
                        autoReadQuestion: false,
                        autoReadAnswer: false,
                    },
                };
            });
            
            useEffect(() => {
                StorageService.save(state);
            }, [state]);
            
            useEffect(() => {
                document.documentElement.classList.toggle('dark', state.theme === 'dark');
            }, [state.theme]);
            
            const addCard = (card) => {
                const newCard = {
                    ...card,
                    id: Date.now().toString(),
                    created: new Date().toISOString(),
                    lastStudied: null,
                    nextReview: null,
                    timesStudied: 0,
                    timesCorrect: 0,
                    easeFactor: 2.5,
                    interval: 0,
                    repetitions: 0,
                    lapses: 0,
                };
                
                setState(prev => ({
                    ...prev,
                    cards: [...prev.cards, newCard],
                    categories: new Set([...prev.categories, card.category].filter(Boolean)),
                }));
            };
            
            const updateCard = (id, updates) => {
                setState(prev => ({
                    ...prev,
                    cards: prev.cards.map(card => 
                        card.id === id ? { ...card, ...updates } : card
                    ),
                    categories: updates.category 
                        ? new Set([...prev.categories, updates.category])
                        : prev.categories,
                }));
            };
            
            const deleteCard = (id) => {
                setState(prev => ({
                    ...prev,
                    cards: prev.cards.filter(card => card.id !== id),
                }));
            };
            
            const addStudySession = (session) => {
                setState(prev => ({
                    ...prev,
                    studySessions: [
                        ...prev.studySessions,
                        { ...session, id: Date.now().toString() },
                    ],
                }));
            };
            
            const toggleTheme = () => {
                setState(prev => ({
                    ...prev,
                    theme: prev.theme === 'dark' ? 'light' : 'dark',
                }));
            };
            
            const toggleTheme = () => {
                setState(prev => ({
                    ...prev,
                    theme: prev.theme === 'dark' ? 'light' : 'dark',
                }));
            };
            
            const handleFileImport = async (e) => {
                const file = e.target.files?.[0];
                if (!file) return;
                
                try {
                    const text = await file.text();
                    const importedCards = parseQAText(text);
                    
                    if (importedCards.length > 0) {
                        // Add all imported cards
                        importedCards.forEach(cardData => addCard(cardData));
                        alert(`Successfully imported ${importedCards.length} additional cards!`);
                    } else {
                        alert('No valid Q&A pairs found in the file.');
                    }
                } catch (error) {
                    console.error('Import failed:', error);
                    alert('Failed to import file. Please check the format.');
                }
                
                // Reset file input
                e.target.value = '';
            };
            
            const parseQAText = (text) => {
                const cards = [];
                
                // Parse Q1) format
                const qPattern = /Q(\d+)\)(.*?)(?=Q\d+\)|$)/gs;
                const matches = [...text.matchAll(qPattern)];
                
                matches.forEach(match => {
                    const [, number, content] = match;
                    const lines = content.trim().split('\n').filter(l => l.trim());
                    
                    if (lines.length >= 2) {
                        const question = lines[0].trim();
                        
                        // Find "Answer:" line
                        const answerIndex = lines.findIndex(line => 
                            line.toLowerCase().includes('answer:')
                        );
                        
                        if (answerIndex !== -1) {
                            // Get answer text after "Answer:"
                            let answer = lines[answerIndex].replace(/answer:\s*/i, '').trim();
                            
                            // Add subsequent lines as part of the answer
                            const remainingLines = lines.slice(answerIndex + 1);
                            if (remainingLines.length > 0) {
                                answer += '\n' + remainingLines.join('\n');
                            }
                            
                            if (question && answer) {
                                cards.push({
                                    question: `Q${number}) ${question}`,
                                    answer: answer.trim(),
                                    category: 'Additional Cards',
                                    tags: ['imported', 'additional'],
                                    difficulty: 'medium',
                                    media: [],
                                });
                            }
                        }
                    }
                });
                
                return cards;
            };
            
            const value = {
                state,
                addCard,
                updateCard,
                deleteCard,
                addStudySession,
                toggleTheme,
                handleFileImport,
            };
            
            return React.createElement(FlashCardsContext.Provider, { value }, children);
        }

        // Main App Component
        function MobileFlashCardsApp() {
            const { state, toggleTheme, addCard, updateCard, deleteCard, addStudySession, handleFileImport } = useFlashCards();
            const { theme, cards, categories } = state;
            
            const [activeView, setActiveView] = useState('cards');
            const [searchQuery, setSearchQuery] = useState('');
            const [selectedCategory, setSelectedCategory] = useState('');
            const [showCardEditor, setShowCardEditor] = useState(false);
            const [editingCard, setEditingCard] = useState(undefined);
            const [isStudying, setIsStudying] = useState(false);
            const [showMenu, setShowMenu] = useState(false);
            
            const filteredCards = useMemo(() => {
                return cards.filter(card => {
                    const matchesSearch = !searchQuery || 
                        card.question.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        card.answer.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        card.tags.some(tag => tag.toLowerCase().includes(searchQuery.toLowerCase()));
                    
                    const matchesCategory = !selectedCategory || card.category === selectedCategory;
                    
                    return matchesSearch && matchesCategory;
                });
            }, [cards, searchQuery, selectedCategory]);
            
            const handleStudyComplete = (results) => {
                addStudySession({
                    date: new Date().toISOString(),
                    duration: results.duration,
                    cardsStudied: results.correct + results.incorrect,
                    correctCount: results.correct,
                    mode: 'standard',
                });
                
                setIsStudying(false);
            };
            
            const startStudyingCard = (card) => {
                setIsStudying(true);
                setActiveView('study');
            };
            
            return (
                <div className={`min-h-screen ${theme === 'dark' ? 'bg-gray-900 text-white' : 'bg-gray-50 text-gray-900'}`}>
                    {/* Header */}
                    <header className={`sticky top-0 z-40 ${
                        theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-200'
                    } border-b backdrop-blur-md bg-opacity-90`}>
                        <div className="px-4 py-3">
                            <div className="flex justify-between items-center">
                                <h1 className="text-xl font-bold">
                                    <span className="bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent">
                                        Flash Cards Pro 🎯
                                    </span>
                                </h1>
                                
                                <div className="flex items-center gap-2">
                                    <button
                                        onClick={toggleTheme}
                                        className={`p-2 rounded-lg ${
                                            theme === 'dark' ? 'hover:bg-gray-700' : 'hover:bg-gray-100'
                                        }`}
                                    >
                                        <Icon name={theme === 'dark' ? 'sun' : 'moon'} />
                                    </button>
                                    
                                    <button
                                        onClick={() => setShowMenu(!showMenu)}
                                        className={`p-2 rounded-lg ${
                                            theme === 'dark' ? 'hover:bg-gray-700' : 'hover:bg-gray-100'
                                        }`}
                                    >
                                        <Icon name="menu" />
                                    </button>
                                </div>
                            </div>
                            
                            {activeView === 'cards' && !isStudying && (
                                <div className="mt-3">
                                    <div className="relative">
                                        <Icon name="search" className="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400" />
                                        <input
                                            type="text"
                                            value={searchQuery}
                                            onChange={(e) => setSearchQuery(e.target.value)}
                                            placeholder="Search cards..."
                                            className={`w-full pl-10 pr-4 py-2 rounded-xl text-base ${
                                                theme === 'dark'
                                                    ? 'bg-gray-700 border-gray-600'
                                                    : 'bg-gray-100 border-gray-300'
                                            } border focus:outline-none focus:ring-2 focus:ring-blue-500`}
                                        />
                                    </div>
                                </div>
                            )}
                        </div>
                    </header>
                    
                    {/* Menu Dropdown */}
                    {showMenu && (
                        <div className="fixed inset-0 z-50" onClick={() => setShowMenu(false)}>
                            <div className={`absolute top-16 right-4 w-48 rounded-xl shadow-lg ${
                                theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-200'
                            } border overflow-hidden`}>
                                <button
                                    onClick={() => {
                                        setShowCardEditor(true);
                                        setShowMenu(false);
                                    }}
                                    className={`w-full px-4 py-3 text-left flex items-center gap-3 ${
                                        theme === 'dark' ? 'hover:bg-gray-700' : 'hover:bg-gray-100'
                                    }`}
                                >
                                    <Icon name="plus" className="w-4 h-4" />
                                    New Card
                                </button>
                                <button
                                    onClick={() => {
                                        StorageService.exportData(state);
                                        setShowMenu(false);
                                    }}
                                    className={`w-full px-4 py-3 text-left flex items-center gap-3 ${
                                        theme === 'dark' ? 'hover:bg-gray-700' : 'hover:bg-gray-100'
                                    }`}
                                >
                                    💾 Export Data
                                </button>
                                <label className={`w-full px-4 py-3 text-left flex items-center gap-3 cursor-pointer ${
                                    theme === 'dark' ? 'hover:bg-gray-700' : 'hover:bg-gray-100'
                                }`}>
                                    📝 Import Additional Cards
                                    <input
                                        type="file"
                                        accept=".txt,.json"
                                        onChange={(e) => {
                                            handleFileImport(e);
                                            setShowMenu(false);
                                        }}
                                        className="hidden"
                                    />
                                </label>
                            </div>
                        </div>
                    )}
                    
                    {/* Main Content */}
                    <main className="px-4 py-4 pb-20">
                        {activeView === 'cards' && !isStudying && (
                            <div className="space-y-4">
                                {/* Category filter */}
                                {categories.size > 0 && (
                                    <div className="flex gap-2 overflow-x-auto pb-2">
                                        <button
                                            onClick={() => setSelectedCategory('')}
                                            className={`px-3 py-2 rounded-xl text-sm font-medium whitespace-nowrap ${
                                                !selectedCategory
                                                    ? 'bg-blue-500 text-white'
                                                    : theme === 'dark'
                                                    ? 'bg-gray-800 text-gray-300'
                                                    : 'bg-gray-200 text-gray-700'
                                            }`}
                                        >
                                            All
                                        </button>
                                        {Array.from(categories).map(cat => (
                                            <button
                                                key={cat}
                                                onClick={() => setSelectedCategory(cat)}
                                                className={`px-3 py-2 rounded-xl text-sm font-medium whitespace-nowrap ${
                                                    selectedCategory === cat
                                                        ? 'bg-blue-500 text-white'
                                                        : theme === 'dark'
                                                        ? 'bg-gray-800 text-gray-300'
                                                        : 'bg-gray-200 text-gray-700'
                                                }`}
                                            >
                                                {cat}
                                            </button>
                                        ))}
                                    </div>
                                )}
                                
                                {/* Cards list */}
                                {filteredCards.length === 0 ? (
                                    <div className="text-center py-12">
                                        <Icon name="study" className="w-16 h-16 mx-auto mb-4 text-gray-400" />
                                        <p className="text-lg mb-2">No cards found</p>
                                        <p className="text-gray-500 mb-4">Create your first card to get started!</p>
                                        <button
                                            onClick={() => setShowCardEditor(true)}
                                            className="px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 font-medium"
                                        >
                                            Create Card
                                        </button>
                                    </div>
                                ) : (
                                    <div className="space-y-3">
                                        {filteredCards.map(card => (
                                            <MobileCardItem
                                                key={card.id}
                                                card={card}
                                                onEdit={() => {
                                                    setEditingCard(card);
                                                    setShowCardEditor(true);
                                                }}
                                                onDelete={() => {
                                                    if (confirm('Delete this card?')) {
                                                        deleteCard(card.id);
                                                    }
                                                }}
                                                onStudy={() => startStudyingCard(card)}
                                            />
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}
                        
                        {activeView === 'study' && !isStudying && (
                            <div className="space-y-6">
                                <h2 className="text-2xl font-bold text-center mb-6">Ready to Study? 📚</h2>
                                
                                <div className={`p-6 rounded-xl ${
                                    theme === 'dark' ? 'bg-gray-800' : 'bg-white'
                                } text-center`}>
                                    <Icon name="brain" className="w-12 h-12 mx-auto mb-4 text-blue-500" />
                                    <h3 className="text-lg font-semibold mb-2">Standard Study Mode</h3>
                                    <p className={`text-sm mb-4 ${
                                        theme === 'dark' ? 'text-gray-400' : 'text-gray-600'
                                    }`}>
                                        Classic flashcard study with self-grading
                                    </p>
                                    <button
                                        onClick={() => setIsStudying(true)}
                                        disabled={filteredCards.length === 0}
                                        className="w-full py-4 bg-blue-500 text-white rounded-xl hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-lg font-medium"
                                    >
                                        Start Studying ({filteredCards.length} cards)
                                    </button>
                                </div>
                            </div>
                        )}
                        
                        {(activeView === 'study' || activeView === 'cards') && isStudying && (
                            <MobileStudyMode
                                cards={filteredCards}
                                onComplete={handleStudyComplete}
                            />
                        )}
                        
                        {activeView === 'stats' && (
                            <div className="space-y-6">
                                <h2 className="text-2xl font-bold text-center">Your Progress 📊</h2>
                                
                                <div className="grid grid-cols-2 gap-4">
                                    <div className={`p-4 rounded-xl ${
                                        theme === 'dark' ? 'bg-gray-800' : 'bg-white'
                                    } text-center`}>
                                        <div className="text-2xl font-bold text-blue-500">{cards.length}</div>
                                        <div className="text-sm text-gray-500">Total Cards</div>
                                    </div>
                                    
                                    <div className={`p-4 rounded-xl ${
                                        theme === 'dark' ? 'bg-gray-800' : 'bg-white'
                                    } text-center`}>
                                        <div className="text-2xl font-bold text-green-500">
                                            {cards.filter(c => c.timesCorrect > 0).length}
                                        </div>
                                        <div className="text-sm text-gray-500">Studied Cards</div>
                                    </div>
                                    
                                    <div className={`p-4 rounded-xl ${
                                        theme === 'dark' ? 'bg-gray-800' : 'bg-white'
                                    } text-center`}>
                                        <div className="text-2xl font-bold text-purple-500">
                                            {Array.from(categories).length}
                                        </div>
                                        <div className="text-sm text-gray-500">Categories</div>
                                    </div>
                                    
                                    <div className={`p-4 rounded-xl ${
                                        theme === 'dark' ? 'bg-gray-800' : 'bg-white'
                                    } text-center`}>
                                        <div className="text-2xl font-bold text-yellow-500">
                                            {state.studySessions.length}
                                        </div>
                                        <div className="text-sm text-gray-500">Study Sessions</div>
                                    </div>
                                </div>
                                
                                <div className={`p-6 rounded-xl ${
                                    theme === 'dark' ? 'bg-gray-800' : 'bg-white'
                                }`}>
                                    <h3 className="text-lg font-semibold mb-4">Recent Activity</h3>
                                    {state.studySessions.length === 0 ? (
                                        <p className="text-gray-500 text-center py-8">No study sessions yet. Start studying to see your progress!</p>
                                    ) : (
                                        <div className="space-y-3">
                                            {state.studySessions.slice(-3).reverse().map(session => (
                                                <div key={session.id} className="flex justify-between items-center">
                                                    <div>
                                                        <div className="font-medium">Study Session</div>
                                                        <div className="text-sm text-gray-500">
                                                            {session.cardsStudied} cards • {Math.floor(session.duration / 60)}m {session.duration % 60}s
                                                        </div>
                                                    </div>
                                                    <div className="text-right">
                                                        <div className="font-medium text-green-500">
                                                            {Math.round((session.correctCount / session.cardsStudied) * 100)}%
                                                        </div>
                                                        <div className="text-xs text-gray-500">accuracy</div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}
                    </main>
                    
                    {/* Card Editor Modal */}
                    {showCardEditor && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center p-4 z-50 overflow-y-auto">
                            <div className={`w-full max-w-lg my-8 rounded-2xl ${
                                theme === 'dark' ? 'bg-gray-900' : 'bg-white'
                            } p-6`}>
                                <h2 className="text-xl font-semibold mb-6">
                                    {editingCard ? 'Edit Card ✏️' : 'Create New Card ➕'}
                                </h2>
                                <MobileCardEditor
                                    card={editingCard}
                                    onSave={(card) => {
                                        if (editingCard) {
                                            updateCard(editingCard.id, card);
                                        } else {
                                            addCard(card);
                                        }
                                        setShowCardEditor(false);
                                        setEditingCard(undefined);
                                    }}
                                    onCancel={() => {
                                        setShowCardEditor(false);
                                        setEditingCard(undefined);
                                    }}
                                />
                            </div>
                        </div>
                    )}
                    
                    {/* Bottom Navigation */}
                    <nav className={`fixed bottom-0 left-0 right-0 z-40 ${
                        theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-200'
                    } border-t`}>
                        <div className="flex justify-around py-2">
                            <button
                                onClick={() => { 
                                    setActiveView('cards'); 
                                    setIsStudying(false); 
                                }}
                                className={`flex flex-col items-center p-3 rounded-lg transition-colors ${
                                    activeView === 'cards' && !isStudying 
                                        ? 'text-blue-500' 
                                        : theme === 'dark' ? 'text-gray-400' : 'text-gray-600'
                                }`}
                            >
                                <Icon name="cards" className="w-6 h-6 mb-1" />
                                <span className="text-xs">Cards</span>
                            </button>
                            <button
                                onClick={() => { 
                                    setActiveView('study'); 
                                    setIsStudying(false); 
                                }}
                                className={`flex flex-col items-center p-3 rounded-lg transition-colors ${
                                    activeView === 'study' || isStudying 
                                        ? 'text-blue-500' 
                                        : theme === 'dark' ? 'text-gray-400' : 'text-gray-600'
                                }`}
                            >
                                <Icon name="study" className="w-6 h-6 mb-1" />
                                <span className="text-xs">Study</span>
                            </button>
                            <button
                                onClick={() => { 
                                    setActiveView('stats'); 
                                    setIsStudying(false); 
                                }}
                                className={`flex flex-col items-center p-3 rounded-lg transition-colors ${
                                    activeView === 'stats' 
                                        ? 'text-blue-500' 
                                        : theme === 'dark' ? 'text-gray-400' : 'text-gray-600'
                                }`}
                            >
                                <Icon name="stats" className="w-6 h-6 mb-1" />
                                <span className="text-xs">Stats</span>
                            </button>
                        </div>
                    </nav>
                </div>
            );
        }

        // Root App
        function App() {
            return React.createElement(
                FlashCardsProvider,
                null,
                React.createElement(MobileFlashCardsApp)
            );
        }

        // Render the app
        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>

    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => console.log('SW registered: ', registration))
                    .catch((registrationError) => console.log('SW registration failed: ', registrationError));
            });
        }
    </script>
</body>
</html>
